<html>
	<head>
		<title>overlay-demo</title>
	</head>

	<body>
		<canvas id="canvas"></canvas>
		<script>
			const electron = require("electron");
			const canvas = document.getElementById("canvas");

			electron.ipcRenderer.on("hello-world", (e, payload) => {
				canvas.width = payload.width;
				canvas.height = payload.height;
				
				const ctx = canvas.getContext("2d");
				ctx.font = "30px Arial";
				ctx.fillStyle = "red"
				ctx.strokeStyle = "red";
				ctx.lineWidth = 5;
			});

			electron.ipcRenderer.on("draw", async (e, payload) => {
				// const toDraw = await canvas.loadImage(payload.image);
				// const blob = new Blob([payload.image], {type: "image/jpg"});
				// const url = URL.createObjectURL(blob);
				// const img = new Image();
				// img.width = canvas.width;
				// img.iehgt = canvas.height;
				// img.src = url;
				
				// const ctx = canvas.getContext("2d");
				// ctx.drawImage(img, 0, 0);

				const ctx = canvas.getContext("2d");
				ctx.clearRect(0, 0, canvas.width, canvas.height);
				for(let toDraw of payload.detections) {
					drawBounds(toDraw.bbox, toDraw.class);
				}
			});

			function drawBounds(bbox, text) {
				const ctx = canvas.getContext("2d");
				ctx.beginPath();
				ctx.rect(bbox[0], bbox[1], bbox[2], bbox[3]);
				ctx.fillText(`${text}\n${JSON.stringify(bbox, null, "\n")}`, bbox[0], bbox[1] + 20);
				ctx.stroke();
			}
		</script>
	</body>
</html>